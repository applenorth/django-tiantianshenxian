{% extends "store/base.html" %}

{% block title %}<title>天天生鲜</title>{% endblock %}
{% block style %}
     <style>
      .store_table{
          line-height: 40px;
          text-align: center;
      }
      .t_label{
          text-align: right;
      }
      .t_message{
          text-align: left;
          color: red;
      }

  </style>
{% endblock %}


{% block content %}
    <div class="container-fluid">
            <div class="card shadow mb-4">
                <div class="card-header py-3">
                  <h4 class="m-0 font-weight-bold text-primary">店铺详情</h4>
                </div>
                <div class="card-body">
                    <form action="" method="post" enctype="multipart/form-data">
                        {% csrf_token %}
                        <table class="table store_table">
                            <tr>
                                <td rowspan="4">
                                    <a href="#" class="thumbnail">
                                        <img src="/static/{{user_store_info.s_logo}}" width="300px">
                                    </a>
                                </td>
                                <th class="t_label">店铺名称</th>
                                <td class="t_input">
                                    <input class="form-control" type="text" placeholder="店铺名称" readonly id="readonly1"
                                           name="s_name" value="{{ user_store_info.s_name }}">
                                    <div id="countdown"></div>
                                </td>
                                <td class="t_message">店铺名称最多每30天修改一次</td>

                            </tr>
                            <tr>
                                <th class="t_label">店铺地址</th>
                                <td class="t_input" colspan="2">
                                    <input class="form-control" type="text" placeholder="店铺地址"
                                           name="s_address" value="{{ user_store_info.s_address }}">
                                </td>
                            </tr>
                            <tr>
                                <th colspan="3">店铺描述</th>
                            </tr>
                            <tr>
                                <td colspan="3">
                                    <textarea class="form-control" name="s_description">{{ user_store_info.s_description }}</textarea>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <input class="btn btn-primary" type="file" value="图片上传" name="s_logo">
                                </td>
                                <td colspan="3">
                                    <button class="btn btn-primary" type="submit" value="发起修改">发起修改</button>
                                </td>
                            </tr>

                        </table>
                    </form>
                </div>
            </div>
        </div>
        <div style="display: none" id="change_time">{{change_datetime}}</div>
{% endblock %}

{% block js %}
    <script src="/static/store/js/echarts.min.js"></script>

    <script>
    var str='';
   // var sec=11000;   //30天有2592000s
    var data=new Date();
    var write_data=$("#change_time").text();  //带小数
    i=setInterval(function(){

        //if(sec>=0){
        //sec=sec-1;
        data=new Date();
        datetime=data.getTime()/1000;  //当前时间的时间戳，单位s

        date_diff=datetime-write_data;  //时间差，单位s

        if(date_diff>2592000){
            str='你现在可以修改店铺名了！';
            $("#readonly1").removeAttr("readonly");  //移除只读属性
            clearInterval(i);
        }

        //}

       // if(sec<=0){
            //str='你现在可以修改店铺名了！';
            //$("#readonly1").removeAttr("readonly");  //移除只读属性
            //clearInterval(i);

        //}
        else{

            // 设置day
            var day=Math.floor(date_diff/60/60/24);
            // 设置hour
            var hour=Math.floor(date_diff/60/60%24);
            // 设置min
            var min=Math.floor(date_diff/60%60);
            // 设置s
            var s=Math.floor(date_diff%60);

            str='距离上次更新：'+day+'天'+hour+'小时'+min+'分钟'+s+'秒';
  
        }
        //显示剩下的时间
        document.getElementById('countdown').innerHTML=str;
    },1000);



</script>

{% endblock %}
